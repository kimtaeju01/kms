"use strict";
// Copyright Amazon.com Inc. or its affiliates. All Rights Reserved.
// SPDX-License-Identifier: Apache-2.0
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
/*
 * This public interface for constructing the additional authenticated data (AAD)
 * is provided for the use of the Encryption SDK for JavaScript only.  It can be used
 * as a reference but is not intended to be use by any packages other than the
 * Encryption SDK for JavaScript.
 *
 * This AAD is used for the Body section
 * See: https://docs.aws.amazon.com/encryption-sdk/latest/developer-guide/body-aad-reference.html
 */
const bn_js_1 = __importDefault(require("bn.js"));
const identifiers_1 = require("./identifiers");
const concat_buffers_1 = require("./concat_buffers");
const uint_util_1 = require("./uint_util");
function aadFactory(fromUtf8) {
    return {
        messageAADContentString,
        messageAAD,
    };
    function messageAADContentString({ contentType, isFinalFrame, }) {
        switch (contentType) {
            case identifiers_1.ContentType.NO_FRAMING:
                return identifiers_1.ContentAADString.NON_FRAMED_STRING_ID;
            case identifiers_1.ContentType.FRAMED_DATA:
                return isFinalFrame
                    ? identifiers_1.ContentAADString.FINAL_FRAME_STRING_ID
                    : identifiers_1.ContentAADString.FRAME_STRING_ID;
            default:
                throw new Error('Unrecognized content type');
        }
    }
    function messageAAD(messageId, aadContentString, seqNum, contentLength) {
        return concat_buffers_1.concatBuffers(messageId, fromUtf8(aadContentString), uint_util_1.uInt32BE(seqNum), new Uint8Array(new bn_js_1.default(contentLength).toArray('be', 8)));
    }
}
exports.aadFactory = aadFactory;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWFkX2ZhY3RvcnkuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvYWFkX2ZhY3RvcnkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLG9FQUFvRTtBQUNwRSxzQ0FBc0M7Ozs7O0FBRXRDOzs7Ozs7OztHQVFHO0FBRUgsa0RBQXNCO0FBQ3RCLCtDQUE2RDtBQUU3RCxxREFBZ0Q7QUFDaEQsMkNBQXNDO0FBRXRDLFNBQWdCLFVBQVUsQ0FBQyxRQUF1QztJQUNoRSxPQUFPO1FBQ0wsdUJBQXVCO1FBQ3ZCLFVBQVU7S0FDWCxDQUFBO0lBRUQsU0FBUyx1QkFBdUIsQ0FBQyxFQUMvQixXQUFXLEVBQ1gsWUFBWSxHQUliO1FBQ0MsUUFBUSxXQUFXLEVBQUU7WUFDbkIsS0FBSyx5QkFBVyxDQUFDLFVBQVU7Z0JBQ3pCLE9BQU8sOEJBQWdCLENBQUMsb0JBQW9CLENBQUE7WUFDOUMsS0FBSyx5QkFBVyxDQUFDLFdBQVc7Z0JBQzFCLE9BQU8sWUFBWTtvQkFDakIsQ0FBQyxDQUFDLDhCQUFnQixDQUFDLHFCQUFxQjtvQkFDeEMsQ0FBQyxDQUFDLDhCQUFnQixDQUFDLGVBQWUsQ0FBQTtZQUN0QztnQkFDRSxNQUFNLElBQUksS0FBSyxDQUFDLDJCQUEyQixDQUFDLENBQUE7U0FDL0M7SUFDSCxDQUFDO0lBRUQsU0FBUyxVQUFVLENBQ2pCLFNBQXFCLEVBQ3JCLGdCQUFrQyxFQUNsQyxNQUFjLEVBQ2QsYUFBcUI7UUFFckIsT0FBTyw4QkFBYSxDQUNsQixTQUFTLEVBQ1QsUUFBUSxDQUFDLGdCQUFnQixDQUFDLEVBQzFCLG9CQUFRLENBQUMsTUFBTSxDQUFDLEVBQ2hCLElBQUksVUFBVSxDQUFDLElBQUksZUFBRSxDQUFDLGFBQWEsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FDdkQsQ0FBQTtJQUNILENBQUM7QUFDSCxDQUFDO0FBdENELGdDQXNDQyJ9